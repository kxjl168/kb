var app=angular.module("myApp",["ngSanitize"]);function showOriImg(){}function initPic(){var i=[];$.each($("img[fid]"),function(e,t){var s={};s.src=$(t).attr("orisrc"),s.opts={};var o=$(t).attr("desc");null!=o&&""!=o&&(s.opts.caption=o),s.opts.thumb=$(t).attr("src"),i.push(s)});var s={transitionEffect:"slide",transitionDuration:800,animationDuration:500};$.each($("img[fid]"),function(e,t){$(t).click(function(){$.fancybox.open(i,s,e)})})}function changerows(e){var t=$(e).val(),s=angular.element(ngSection).scope();s.$apply(function(){s.rows=t,s.getList()})}function refreshNum(){var e=angular.element(ngSection).scope();e.$apply(function(){e.getgoodnum()})}function closepop(){$(".pbtn").popover("hide")}function init(){initmenu_p($("#menuul"),"pulbic/detail/"),$("#collapseOne").on("shown.bs.collapse",function(){$("#titlepic").attr("class","glyphicon glyphicon-chevron-up pull-right")}),$("#collapseOne").on("hidden.bs.collapse",function(){$("#titlepic").attr("class","glyphicon glyphicon-chevron-down pull-right")}),$(".modal").on("show.bs.modal",function(){$(this).draggable(),$(this).css("overflow-y","scroll")});var $scope=angular.element(ngSection).scope();$scope.$apply(function(){var http=getImUrl();$scope.ff=function(e){$(".pall").toggleClass("is-open")},$scope.initimg=function(){var o,i,l="#bigimg",p="#outdiv",r=".indiv",u=$(window).width(),d=$(window).height();function e(e){if($(p).is(":visible")){var t=e||window.event,s=t.wheelDelta||t.detail;t.preventDefault?t.preventDefault():t.returnValue=!1,0<s?o():i()}}$(".indiv").find("img").load(function(){var e=this.width,t=this.height;if(void 0===this.naturalWidth){var s=new Image;s.src=this.src,e=s.width,t=s.height}else e=this.naturalWidth,t=this.naturalHeight;if(u<e){var o,i=.8*d,n=e/t*i;"10%",o=(d-(i=t/e*(n=.65*u)))/2+"px",$(l).css("width",n+"px").css("height",i+"px"),$(r).css({left:"10%",top:o})}else{$(l).css("width",e+"px").css("height",t+"px");var c=(u-e)/2,a=(d-t)/2;$(r).css({left:c,top:a})}$(p).click(function(){$(p).fadeOut("normal")})}),$(".pageText").find("img").each(function(e,n){$(n).click(function(){var e=this.src,t=e.lastIndexOf("."),s=e.substr(0,t),o=e.substr(t),i=$(n).attr("orisrc");null==i&&(i=s+"_orign"+o),$(l).attr("src",i),$(p).fadeIn("normal")})}),$(l),o=function(){var e=1.03*$(l).css("height").substr(0,$(l).css("height").length-2),t=1.03*$(l).css("width").substr(0,$(l).css("width").length-2);$(l).css({height:e+"px",width:t+"px"})},i=function(){var e=$(l).css("height").substr(0,$(l).css("height").length-2)/1.03,t=$(l).css("width").substr(0,$(l).css("width").length-2)/1.03;$(l).css({height:e+"px",width:t+"px"})},document.attachEvent?document.attachEvent("onmousewheel",e):document.addEventListener&&(document.addEventListener("mousewheel",e,!1),document.addEventListener("DOMMouseScroll",e,!1))},$scope.title=sitetitle,$scope.page=1,$scope.rows=10,$scope.rows_select=[5,10,20],setTimeout(function(){$("div.tablefoot select").val($scope.rows)},50),$scope.pageData=[],$scope.getgoodnum=function(imei){var obj=new Object;void 0===imei?(obj.i=GetQueryString("i"),null==obj.i&&(obj.i=$scope.getIMEI())):obj.i=imei,SZUMWS(http+"bloglike/goodnum.action",JSON.stringify(obj),function succsess(json){var code=json.ResponseCode,message=json.ResponseMsg;200==code?($scope.goodnum=eval(json.total),0==$scope.goodnum&&($scope.goodnum=""),$("#gdnum").html($scope.goodnum),$("#rdnum").html(json.view_num),$("#rpnum").html(json.replay_num),$("#spidernum").html(json.spider_num),null!=json.showtime&&"1"==json.showtime&&json.days>json.maxday&&($("#days").html(json.days),$("#timediv").removeClass("hide")),$scope.$apply()):msg(message)},function(){},!1,!1)},$scope.good=function(imei){var obj=new Object;void 0===imei?(obj.imei=GetQueryString("i"),null==obj.imei&&(obj.imei=$scope.getIMEI())):obj.imei=imei;var uid=getUUID("myCanvas");obj.cookie=uid,SZUMWS(http+"bloglike/good.action",JSON.stringify(obj),function succsess(json){var code=json.ResponseCode,message=json.ResponseMsg;200==code?($scope.goodnum=eval(json.total),$("#gdnum").html($scope.goodnum),$scope.$apply()):msg(message)},function(){},!1,"json")},$scope.pay=function(e){$("#payMd").modal("show")},$scope.getRelatedList=function(imei){var obj=new Object;void 0===imei?(obj.i=GetQueryString("i"),null==obj.i&&(obj.i=$scope.getIMEI())):obj.i=imei,SZUMWS(http+"blog/getRelatedList.action",JSON.stringify(obj),function succsess(json){var code=json.ResponseCode,message=json.ResponseMsg;if(200==code){$scope.relatedlist=eval(json.datalist);var html="";html+='   <ul class="col-xs-12 ">',$.each($scope.relatedlist,function(e,t){html+=' <li >   \t<img class="nopaddding img-responsive col-xs-2"  \tstyle="width: 25px; height: 25px;"  \ttitle="'+t.blog_type_name+'"  \tsrc="'+t.blog_type_url+'"> <a  \t\thref="'+basePath+"/public/html/"+t.showdate+"/"+t.imei+'.html"   \t\tclass="col-sm-8 col-xs-11 ">'+t.title+"</a>  </li> "}),html+="   </ul>",$(".relatedLink").html(html),$scope.datalist=eval(json.prenextlist),$scope.x=$scope.datalist[0],1<$scope.datalist.length&&($scope.datalist[1].recordid>$scope.x.recordid?$scope.next=$scope.datalist[1]:$scope.pre=$scope.datalist[1]),2<$scope.datalist.length&&($scope.pre=$scope.datalist[2]);var prenexthtml="";null!=$scope.pre&&(prenexthtml+=' <ul class="pagination pull-left">  <li> <a  href="'+basePath+"/public/html/"+$scope.pre.showdate+"/"+$scope.pre.imei+'.html" style="" class="for spider">前一篇:'+$scope.pre.title+"</a> </li></ul>"),null!=$scope.next&&(prenexthtml+=' <ul class="pagination pull-right"> \t<li> <a href="'+basePath+"/public/html/"+$scope.next.showdate+"/"+$scope.next.imei+'.html" style="" class="for spider">后一篇:'+$scope.next.title+"</a>  </li> </ul>"),$(".prenexlist").html(prenexthtml),$scope.getgoodnum(),$scope.$apply()}else msg(message)},function(){},!1,!1)},$scope.getIMEI=function(){var e=window.location.href.lastIndexOf("/"),t=window.location.href.lastIndexOf(".html"),s=window.location.href.substr(e+1);return 0<t&&(s=window.location.href.substr(e+1,t-e-1)),s},$scope.getList=function(imei,fucOnFinished,clear){$scope.page=1,$scope.pre=$scope.next=null;var obj=new Object;void 0===imei?(obj.i=GetQueryString("i"),null==obj.i&&(obj.i=$scope.getIMEI())):obj.i=imei,obj.page=$scope.page,obj.rows=$scope.rows,SZUMWS(http+"blog/getDetailList.action",JSON.stringify(obj),function succsess(json){var code=json.ResponseCode,message=json.ResponseMsg;if(200==code){$scope.datalist=eval(json.datalist),0<$scope.datalist.length&&($scope.x=$scope.datalist[0],$scope.x.context=unescape($scope.x.content),$("#rdnum").html($scope.x.view_nums),$("#rpnum").html($scope.x.replay_nums)),1<$scope.datalist.length&&($scope.datalist[1].recordid>$scope.x.recordid?$scope.next=$scope.datalist[1]:$scope.pre=$scope.datalist[1]),2<$scope.datalist.length&&($scope.pre=$scope.datalist[2]),$scope.total=json.total,$scope.pageDataPre=[],$scope.pageDataAft=[],$scope.pageNum=Math.ceil($scope.total/$scope.rows);for(var i=$scope.page-3;i<$scope.page;i++)0<i&&$scope.pageDataPre.push(i);for(var i=$scope.page+1;i<$scope.page+3;i++)i<=$scope.pageNum&&$scope.pageDataAft.push(i);$scope.$apply(),$(".pct").autoMenu(),$scope.getRelatedList(),$("pre code").each(function(e,t){hljs.highlightBlock(t)}),$("#title").html($scope.x.title),document.title=$scope.x.title+"-"+$scope.title;var meta=document.getElementsByTagName("meta");meta.keywords.setAttribute("content",$scope.x.tags),$scope.initimg(),console.log("-----guideList -OK= ")}else msg(message)},function(){msg("net work error！"),null!=fucOnFinished&&fucOnFinished()},!1,!1)},setTimeout(function(){$scope.getRelatedList()},50)})}app.controller("eduCtrl",function(e,t){}),$(function(){init(),hljs.initHighlightingOnLoad(),$(".paytype").click(function(){var e=$(this).attr("for");$(".paycontent").find(".tab-pane").removeClass("active"),$(e).addClass("active")}),$(".pctnew").autoMenu(),$("#title").html($(".ptitle").html()),document.title=$(".ptitle").html()+"-"+sitetitle,document.getElementsByTagName("meta").keywords.setAttribute("content",$("#tagstrval").val());var e=angular.element(ngSection).scope();e.$apply(function(){e.x={},e.x.imei=$("#imei").val(),setTimeout(function(){e.getReplayList()},300)}),initPic()}),app.filter("sanitize",["$sce",function(e){return function(e){}}]);